<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Love Surprise üíñ</title>

<style>
body{
  font-family:sans-serif;
  background:linear-gradient(135deg,#ff9acb,#ff6fa5);
  margin:0;
  padding:0;
}
.container{
  max-width:400px;
  margin:40px auto;
  background:white;
  padding:25px;
  border-radius:20px;
  box-shadow:0 10px 30px rgba(0,0,0,0.2);
}
h2{text-align:center;color:#ff3f8b}
input,textarea{
  width:100%;
  padding:10px;
  margin:10px 0;
  border-radius:10px;
  border:1px solid #ddd;
}
button{
  width:100%;
  padding:12px;
  border:none;
  border-radius:30px;
  background:#ff4f93;
  color:white;
  font-size:16px;
  cursor:pointer;
}
.hidden{display:none}
.linkBox{
  background:#f3f3f3;
  padding:10px;
  border-radius:10px;
  margin-top:10px;
  word-break:break-all;
}
</style>
</head>
<body>

<div id="app"></div>

<script>

// ===== ‡∏≠‡πà‡∏≤‡∏ô query parameter ‡πÅ‡∏ö‡∏ö‡πÄ‡∏™‡∏ñ‡∏µ‡∏¢‡∏£ =====
function getDataFromURL(){
  const url = new URL(window.location.href);
  return url.searchParams.get("data");
}

// ===== ‡∏ñ‡∏≠‡∏î‡∏£‡∏´‡∏±‡∏™‡∏†‡∏≤‡∏©‡∏≤‡πÑ‡∏ó‡∏¢‡πÅ‡∏ö‡∏ö‡πÑ‡∏°‡πà‡∏û‡∏±‡∏á =====
function decodeBase64Unicode(str) {
  return decodeURIComponent(
    atob(str).split('').map(function(c) {
      return '%' + ('00' + c.charCodeAt(0).toString(16)).slice(-2);
    }).join('')
  );
}

// ===== ‡πÅ‡∏™‡∏î‡∏á‡∏´‡∏ô‡πâ‡∏≤‡πÄ‡∏ã‡∏≠‡∏£‡πå‡πÑ‡∏û‡∏£‡∏™‡πå =====
function showMemory(data){

let yt="";
if(data.youtube){
let id="";
if(data.youtube.includes("youtu.be")){
id=data.youtube.split("youtu.be/")[1];
}else if(data.youtube.includes("v=")){
id=data.youtube.split("v=")[1].split("&")[0];
}
if(id){
yt=`<iframe width="100%" height="200"
src="https://www.youtube.com/embed/${id}"
frameborder="0" allowfullscreen></iframe>`;
}
}

document.getElementById("app").innerHTML=`
<div class="container">
<h2>${data.title}</h2>
<p>${data.story}</p>
${yt}
<p style="color:#ff1493;">üíñ ‡πÄ‡∏õ‡∏¥‡∏î‡∏î‡∏π‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à</p>
</div>
`;
}

// ===== ‡∏ñ‡πâ‡∏≤‡∏°‡∏µ data ‡πÉ‡∏ô‡∏•‡∏¥‡∏á‡∏Å‡πå =====
const memory = getDataFromURL();

if(memory){

let data = JSON.parse(decodeBase64Unicode(memory));

if(data.password){

document.getElementById("app").innerHTML=`
<div class="container">
<h2>üîê ‡πÉ‡∏™‡πà‡∏£‡∏´‡∏±‡∏™ 6 ‡∏´‡∏•‡∏±‡∏Å</h2>
<input id="pass">
<button onclick="unlock()">‡πÄ‡∏õ‡∏¥‡∏î‡∏î‡∏π</button>
<p id="wrong" style="color:red;"></p>
</div>
`;

window.unlock=function(){
let input=document.getElementById("pass").value;
if(input===data.password){
showMemory(data);
}else{
document.getElementById("wrong").innerText="‡∏£‡∏´‡∏±‡∏™‡πÑ‡∏°‡πà‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á";
}
}

}else{
showMemory(data);
}

}else{

// ===== ‡∏´‡∏ô‡πâ‡∏≤‡πÅ‡∏£‡∏Å‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏•‡∏¥‡∏á‡∏Å‡πå =====
document.getElementById("app").innerHTML=`
<div class="container">
<h2>‡∏™‡∏£‡πâ‡∏≤‡∏á‡πÄ‡∏ã‡∏≠‡∏£‡πå‡πÑ‡∏û‡∏£‡∏™‡πå‡πÉ‡∏´‡πâ‡πÅ‡∏ü‡∏ô üíï</h2>

<input id="title" placeholder="‡∏ä‡∏∑‡πà‡∏≠‡πÄ‡∏£‡∏∑‡πà‡∏≠‡∏á">
<textarea id="story" placeholder="‡πÄ‡∏Ç‡∏µ‡∏¢‡∏ô‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ñ‡∏∂‡∏á‡πÅ‡∏ü‡∏ô"></textarea>
<input id="youtube" placeholder="‡∏•‡∏¥‡∏á‡∏Å‡πå YouTube (‡πÑ‡∏°‡πà‡πÉ‡∏™‡πà‡∏Å‡πá‡πÑ‡∏î‡πâ)">

<label>
<input type="checkbox" id="usePass"> ‡∏ï‡∏±‡πâ‡∏á‡∏£‡∏´‡∏±‡∏™‡∏ú‡πà‡∏≤‡∏ô 6 ‡∏´‡∏•‡∏±‡∏Å
</label>

<input id="password" placeholder="‡∏£‡∏´‡∏±‡∏™ 6 ‡∏´‡∏•‡∏±‡∏Å" maxlength="6">

<button onclick="createLink()">‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏•‡∏¥‡∏á‡∏Å‡πå üíñ</button>

<div id="result"></div>
</div>
`;

window.createLink=function(){

let title=document.getElementById("title").value.trim();
let story=document.getElementById("story").value.trim();
let usePass=document.getElementById("usePass").checked;
let password=document.getElementById("password").value;

if(title==="" || story===""){
alert("‡∏Å‡∏£‡∏≠‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÉ‡∏´‡πâ‡∏Ñ‡∏£‡∏ö");
return;
}

if(usePass && !/^[0-9]{6}$/.test(password)){
alert("‡∏£‡∏´‡∏±‡∏™‡∏ï‡πâ‡∏≠‡∏á‡πÄ‡∏õ‡πá‡∏ô‡∏ï‡∏±‡∏ß‡πÄ‡∏•‡∏Ç 6 ‡∏´‡∏•‡∏±‡∏Å");
return;
}

let data={
title:title,
story:story,
youtube:document.getElementById("youtube").value,
password:usePass?password:null
};

let encoded=btoa(unescape(encodeURIComponent(JSON.stringify(data))));
let base=window.location.origin + window.location.pathname;
let link=base + "?data=" + encoded;

document.getElementById("result").innerHTML=
`<div class="linkBox">
<b>‡∏•‡∏¥‡∏á‡∏Å‡πå‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏∏‡∏ì:</b><br>
<input value="${link}" onclick="this.select()">
</div>`;
}

}

</script>

</body>
</html>
